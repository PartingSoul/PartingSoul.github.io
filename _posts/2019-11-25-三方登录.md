---
layout:     post
title:      三方登录
subtitle:
date:       2019-11-25
author:     parting_soul
header-img: img/post_bg.jpg
catalog: true
tags:
    - Android
---

## 简述

​	用于将三方登录与项目进行解耦，需要在项目中引入对应三方登录的依赖，目前支持的登录方式有Google，FaceBook以及ShareSDK中的微信，QQ，微博方式。在打渠道包时，若不同的渠道需要使用不同的三方登录方式，可以降低代码的维护成本。

###  一. Google 登录

####  1.1 在项目的build.gradle中引入google services 插件

```groovy
buildscript {
    repositories {
        google()
        jcenter()
    }
    dependencies {
        classpath 'com.android.tools.build:gradle:3.3.1'
        // google-services plugin
        classpath 'com.google.gms:google-services:4.2.0'
    }
}
```

#### 1.2 在app的build.gradle加入google登录对应依赖

```groovy
dependencies {
    ...
    googleplayImplementation 'com.google.android.gms:play-services-auth:16.0.1'
}
apply plugin: 'com.google.gms.google-services'
```

#### 1.3 使用示例

```java
BaseThirdPartLoginManager manager = LoginHelper.getInstance().getLoginManger(this, LoginType.LOGIN_TYPE_GOOGLE);
        manager.login(new OnLoginResultCallback() {
            @Override
            public void onSuccess(ThirdLoginUserBean bean) {
            }

            @Override
            public void onError(String message) {
            }

            @Override
            public void onCancel() {
            }
        });
```

### 二. FaceBook登录

#### 2.1 引入facebook依赖

```groovy
googleplayImplementation 'com.facebook.android:facebook-login:[4,5)'
```

#### 2.2 在app的Manifest中配置与Facebook登录相关的操作

```xml
 <!-- facebook -->
        <meta-data
            android:name="com.facebook.sdk.ApplicationId"
            android:value="@string/facebook_app_id" />

        <activity
            android:name="com.facebook.FacebookActivity"
            android:configChanges="keyboard|keyboardHidden|screenLayout|screenSize|orientation"
            android:label="@string/app_name" />
        <activity
            android:name="com.facebook.CustomTabActivity"
            android:exported="true">
            <intent-filter><action android:name="android.intent.action.VIEW" />

                <category android:name="android.intent.category.DEFAULT" />
                <category android:name="android.intent.category.BROWSABLE" />

                <data android:scheme="@string/fb_login_protocol_scheme" />
            </intent-filter>
        </activity>
        <!-- facebook -->
```

#### 2.3 使用示例

```java
 BaseThirdPartLoginManager manager = LoginHelper.getInstance().getLoginManger(this, LoginType.LOGIN_TYPE_FACEBOOK);
        manager.login(new OnLoginResultCallback() {
            @Override
            public void onSuccess(ThirdLoginUserBean bean) {
            }

            @Override
            public void onError(String message) {
            
            }

            @Override
            public void onCancel() {
            }
        });
```





